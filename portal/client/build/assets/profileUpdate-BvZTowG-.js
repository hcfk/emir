import{r as i,j as e,y as f}from"./index-BSsz9qxB.js";import{C as E,a as S}from"./CCardBody-D3Dx3XpO.js";import{C as P}from"./CCardHeader-C2979ekI.js";import{C as x}from"./CAlert-C3a4Yw5P.js";import{C as F}from"./CForm-CiFAbnKG.js";import{C as g}from"./CFormLabel-AmSnGjPJ.js";import{C,b as j}from"./CFormInput-DYeOzx3L.js";import{C as N,a as k}from"./CRow-dc-zHPub.js";import{a as w}from"./CButton-CAzkA97O.js";import"./CConditionalPortal-CrZp0K_G.js";const D=()=>{const[s,m]=i.useState({username:"",email:"",telegram_username:"",whatsapp_number:""}),[c,d]=i.useState(""),[u,n]=i.useState(""),[t,h]=i.useState({});i.useEffect(()=>{(async()=>{var o;try{const a=localStorage.getItem("token"),l=await f.get("/users/profile",{headers:{Authorization:`Bearer ${a}`}});m(l.data.user),n("")}catch(a){console.error("Error on getting profile:",((o=a.response)==null?void 0:o.data)||a.message),n("Profile cannot be retrieved.")}})()},[]);const p=r=>{m({...s,[r.target.name]:r.target.value}),h({...t,[r.target.name]:""})},y=r=>/\S+@\S+\.\S+/.test(r),v=()=>{const r={};return s.username||(r.username="Username is mandatory."),s.email?y(s.email)||(r.email="wrong email formay."):r.email="email is mandatory.",h(r),Object.keys(r).length===0},b=async r=>{var o;if(r.preventDefault(),!!v())try{const a=localStorage.getItem("token"),{data:l}=await f.put(`/users/update-user/${s._id}`,s,{headers:{Authorization:`Bearer ${a}`}});d(l.message),n(""),console.log("Profile successfully updated.",l.user)}catch(a){console.error("Error updating the profile.",((o=a.response)==null?void 0:o.data)||a.message),n("While updating profile an error occured."),d("")}};return e.jsxs(E,{className:"mt-4",children:[e.jsx(P,{children:e.jsx("h5",{children:"Update Profile"})}),e.jsxs(S,{children:[c&&e.jsx(x,{color:"success",children:c}),u&&e.jsx(x,{color:"danger",children:u}),e.jsxs(F,{onSubmit:b,noValidate:!0,children:[e.jsxs("div",{className:"mb-3",children:[e.jsx(g,{htmlFor:"username",children:"User Name"}),e.jsx(C,{type:"text",id:"username",name:"username",placeholder:"username",value:s.username,onChange:p,invalid:!!t.username}),e.jsx("small",{className:"text-muted",children:"your username is required."}),t.username&&e.jsx(j,{invalid:!0,children:t.username})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(g,{htmlFor:"email",children:"Email"}),e.jsx(C,{type:"email",id:"email",name:"email",placeholder:"Email adresinizi giriniz",value:s.email,onChange:p,invalid:!!t.email}),e.jsx("small",{className:"text-muted",children:"Please input a valid email address"}),t.email&&e.jsx(j,{invalid:!0,children:t.email})]}),e.jsx(N,{children:e.jsx(k,{className:"text-right",children:e.jsx(w,{color:"primary",type:"submit",children:"Update Profile"})})})]})]})]})};export{D as default};
