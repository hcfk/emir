import{r as d,_ as y,R as s,a as i,c as N,P as l,b as I,y as Y,j as o}from"./index-BSsz9qxB.js";import{a as V}from"./CButton-CAzkA97O.js";import{u as xe,T as Ee,C as fe,a as je,b as ke}from"./CConditionalPortal-CrZp0K_G.js";import{C as be}from"./CForm-CiFAbnKG.js";import{C as $}from"./CFormLabel-AmSnGjPJ.js";import{a as ve,C as _}from"./CFormInput-DYeOzx3L.js";var ee=d.forwardRef(function(e,a){var r,t=e.children,m=e.className,c=e.feedback,p=e.feedbackInvalid,b=e.feedbackValid,h=e.floatingClassName,v=e.floatingLabel,P=e.htmlSize,j=e.id,x=e.invalid,g=e.label,w=e.options,k=e.size,F=e.text,A=e.tooltipFeedback,R=e.valid,T=y(e,["children","className","feedback","feedbackInvalid","feedbackValid","floatingClassName","floatingLabel","htmlSize","id","invalid","label","options","size","text","tooltipFeedback","valid"]);return s.createElement(ve,{describedby:T["aria-describedby"],feedback:c,feedbackInvalid:p,feedbackValid:b,floatingClassName:h,floatingLabel:v,id:j,invalid:x,label:g,text:F,tooltipFeedback:A,valid:R},s.createElement("select",i({id:j,className:N("form-select",(r={},r["form-select-".concat(k)]=k,r["is-invalid"]=x,r["is-valid"]=R,r),m),size:P},T,{ref:a}),w?w.map(function(n,f){return s.createElement("option",i({},typeof n=="object"&&n.disabled&&{disabled:n.disabled},typeof n=="object"&&n.value!==void 0&&{value:n.value},{key:f}),typeof n=="string"?n:n.label)}):t))});ee.propTypes=i({className:l.string,htmlSize:l.number,options:l.array},ve.propTypes);ee.displayName="CFormSelect";var re=d.forwardRef(function(e,a){var r=e.children,t=e.className,m=y(e,["children","className"]);return s.createElement("div",i({className:N("modal-content",t)},m,{ref:a}),r)});re.propTypes={children:l.node,className:l.string};re.displayName="CModalContent";var le=d.forwardRef(function(e,a){var r,t=e.children,m=e.alignment,c=e.className,p=e.fullscreen,b=e.scrollable,h=e.size,v=y(e,["children","alignment","className","fullscreen","scrollable","size"]);return s.createElement("div",i({className:N("modal-dialog",(r={"modal-dialog-centered":m==="center"},r[typeof p=="boolean"?"modal-fullscreen":"modal-fullscreen-".concat(p,"-down")]=p,r["modal-dialog-scrollable"]=b,r["modal-".concat(h)]=h,r),c)},v,{ref:a}),t)});le.propTypes={alignment:l.oneOf(["top","center"]),children:l.node,className:l.string,fullscreen:l.oneOfType([l.bool,l.oneOf(["sm","md","lg","xl","xxl"])]),scrollable:l.bool,size:l.oneOf(["sm","lg","xl"])};le.displayName="CModalDialog";var ye=d.createContext({}),W=d.forwardRef(function(e,a){var r=e.children,t=e.alignment,m=e.backdrop,c=m===void 0?!0:m,p=e.className,b=e.container,h=e.duration,v=h===void 0?150:h,P=e.focus,j=P===void 0?!0:P,x=e.fullscreen,g=e.keyboard,w=g===void 0?!0:g,k=e.onClose,F=e.onClosePrevented,A=e.onShow,R=e.portal,T=R===void 0?!0:R,n=e.scrollable,f=e.size,O=e.transition,E=O===void 0?!0:O,u=e.unmountOnClose,L=u===void 0?!0:u,M=e.visible,Q=y(e,["children","alignment","backdrop","className","container","duration","focus","fullscreen","keyboard","onClose","onClosePrevented","onShow","portal","scrollable","size","transition","unmountOnClose","visible"]),se=d.useRef(null),D=d.useRef(null),ge=d.useRef(null),Ce=xe(a,D),te=d.useState(M),z=te[0],X=te[1],ce=d.useState(!1),ie=ce[0],de=ce[1],Ne={visible:z,setVisible:X};d.useEffect(function(){X(M)},[M]),d.useEffect(function(){var C;return z?(se.current=document.activeElement,document.addEventListener("mouseup",ue),document.addEventListener("keydown",pe)):(C=se.current)===null||C===void 0||C.focus(),function(){document.removeEventListener("mouseup",ue),document.removeEventListener("keydown",pe)}},[z]);var me=function(){if(c==="static")return de(!0);X(!1)};d.useLayoutEffect(function(){F&&F(),setTimeout(function(){return de(!1)},v)},[ie]),d.useLayoutEffect(function(){return z?(document.body.classList.add("modal-open"),c&&(document.body.style.overflow="hidden",document.body.style.paddingRight="0px"),setTimeout(function(){var C;j&&((C=D.current)===null||C===void 0||C.focus())},E?v:0)):(document.body.classList.remove("modal-open"),c&&(document.body.style.removeProperty("overflow"),document.body.style.removeProperty("padding-right"))),function(){document.body.classList.remove("modal-open"),c&&(document.body.style.removeProperty("overflow"),document.body.style.removeProperty("padding-right"))}},[z]);var ue=function(C){D.current&&D.current==C.target&&me()},pe=function(C){C.key==="Escape"&&w&&me()};return s.createElement(s.Fragment,null,s.createElement(Ee,{in:z,mountOnEnter:!0,nodeRef:D,onEnter:A,onExit:k,unmountOnExit:L,timeout:E?v:0},function(C){return s.createElement(fe,{container:b,portal:T},s.createElement(ye.Provider,{value:Ne},s.createElement("div",i({className:N("modal",{"modal-static":ie,fade:E,show:C==="entered"},p),tabIndex:-1},z?{"aria-modal":!0,role:"dialog"}:{"aria-hidden":"true"},{style:i({},C!=="exited"&&{display:"block"})},Q,{ref:Ce}),s.createElement(le,{alignment:t,fullscreen:x,scrollable:n,size:f},s.createElement(re,{ref:ge},r)))))}),c&&s.createElement(fe,{container:b,portal:T},s.createElement(je,{visible:z})))});W.propTypes={alignment:l.oneOf(["top","center"]),backdrop:l.oneOfType([l.bool,l.oneOf(["static"])]),children:l.node,className:l.string,container:l.any,duration:l.number,focus:l.bool,fullscreen:l.oneOfType([l.bool,l.oneOf(["sm","md","lg","xl","xxl"])]),keyboard:l.bool,onClose:l.func,onClosePrevented:l.func,onShow:l.func,portal:l.bool,scrollable:l.bool,size:l.oneOf(["sm","lg","xl"]),transition:l.bool,unmountOnClose:l.bool,visible:l.bool};W.displayName="CModal";var G=d.forwardRef(function(e,a){var r=e.children,t=e.className,m=y(e,["children","className"]);return s.createElement("div",i({className:N("modal-body",t)},m,{ref:a}),r)});G.propTypes={children:l.node,className:l.string};G.displayName="CModalBody";var K=d.forwardRef(function(e,a){var r=e.children,t=e.className,m=y(e,["children","className"]);return s.createElement("div",i({className:N("modal-footer",t)},m,{ref:a}),r)});K.propTypes={children:l.node,className:l.string};K.displayName="CModalFooter";var Z=d.forwardRef(function(e,a){var r=e.children,t=e.className,m=e.closeButton,c=m===void 0?!0:m,p=y(e,["children","className","closeButton"]),b=d.useContext(ye).setVisible;return s.createElement("div",i({className:N("modal-header",t)},p,{ref:a}),r,c&&s.createElement(ke,{onClick:function(){return b(!1)}}))});Z.propTypes={children:l.node,className:l.string,closeButton:l.bool};Z.displayName="CModalHeader";var U=d.forwardRef(function(e,a){var r,t=e.children,m=e.className,c=e.color,p=y(e,["children","className","color"]);return s.createElement("thead",i({className:N((r={},r["table-".concat(c)]=c,r),m)||void 0},p,{ref:a}),t)});U.propTypes={children:l.node,className:l.string,color:I};U.displayName="CTableHead";var B=d.forwardRef(function(e,a){var r,t=e.children,m=e.className,c=e.color,p=y(e,["children","className","color"]);return s.createElement("th",i({className:N((r={},r["table-".concat(c)]=c,r),m)||void 0},p,{ref:a}),t)});B.propTypes={children:l.node,className:l.string,color:I};B.displayName="CTableHeaderCell";var q=d.forwardRef(function(e,a){var r,t=e.children,m=e.className,c=e.color,p=y(e,["children","className","color"]);return s.createElement("tbody",i({className:N((r={},r["table-".concat(c)]=c,r),m)||void 0},p,{ref:a}),t)});q.propTypes={children:l.node,className:l.string,color:I};q.displayName="CTableBody";var S=d.forwardRef(function(e,a){var r,t=e.children,m=e.active,c=e.align,p=e.className,b=e.color,h=y(e,["children","active","align","className","color"]),v=h.scope?"th":"td";return s.createElement(v,i({className:N((r={},r["align-".concat(c)]=c,r["table-active"]=m,r["table-".concat(b)]=b,r),p)||void 0},h,{ref:a}),t)});S.propTypes={active:l.bool,align:l.oneOf(["bottom","middle","top"]),children:l.node,className:l.string,color:I};S.displayName="CTableDataCell";var H=d.forwardRef(function(e,a){var r,t=e.children,m=e.active,c=e.align,p=e.className,b=e.color,h=y(e,["children","active","align","className","color"]);return s.createElement("tr",i({className:N((r={},r["align-".concat(c)]=c,r["table-active"]=m,r["table-".concat(b)]=b,r),p)||void 0},h,{ref:a}),t)});H.propTypes={active:l.bool,align:l.oneOf(["bottom","middle","top"]),children:l.node,className:l.string,color:I};H.displayName="CTableRow";var J=d.forwardRef(function(e,a){var r,t=e.children,m=e.className,c=e.color,p=y(e,["children","className","color"]);return s.createElement("tfoot",i({className:N((r={},r["table-".concat(c)]=c,r),m)||void 0},p,{ref:a}),t)});J.propTypes={children:l.node,className:l.string,color:I};J.displayName="CTableFoot";var oe=d.forwardRef(function(e,a){var r=e.children,t=y(e,["children"]);return s.createElement("caption",i({},t,{ref:a}),r)});oe.propTypes={children:l.node};oe.displayName="CTableCaption";var ae=function(e){var a=e.children,r=e.responsive,t=y(e,["children","responsive"]);return r?s.createElement("div",i({className:typeof r=="boolean"?"table-responsive":"table-responsive-".concat(r)},t),a):s.createElement(s.Fragment,null,a)};ae.propTypes={children:l.node,responsive:l.oneOfType([l.bool,l.oneOf(["sm","md","lg","xl","xxl"])])};ae.displayName="CTableResponsiveWrapper";var he=function(e){return e.replace(/[-_.]/g," ").replace(/ +/g," ").replace(/([a-z0-9])([A-Z])/g,"$1 $2").split(" ").map(function(a){return a.charAt(0).toUpperCase()+a.slice(1)}).join(" ")},we=function(e){var a;return typeof e=="object"?(a=e.label)!==null&&a!==void 0?a:he(e.key):he(e)},Te=function(e,a){return e?e.map(function(r){return typeof r=="object"?r.key:r}):a&&Pe(a)},Pe=function(e){return Object.keys(e[0]||{}).filter(function(a){return a.charAt(0)!=="_"})},ne=d.forwardRef(function(e,a){var r,t=e.children,m=e.align,c=e.borderColor,p=e.bordered,b=e.borderless,h=e.caption,v=e.captionTop,P=e.className,j=e.color,x=e.columns,g=e.footer,w=e.hover,k=e.items,F=e.responsive,A=e.small,R=e.striped,T=e.stripedColumns,n=e.tableFootProps,f=e.tableHeadProps,O=y(e,["children","align","borderColor","bordered","borderless","caption","captionTop","className","color","columns","footer","hover","items","responsive","small","striped","stripedColumns","tableFootProps","tableHeadProps"]),E=d.useMemo(function(){return Te(x,k)},[x,k]);return s.createElement(ae,{responsive:F},s.createElement("table",i({className:N("table",(r={},r["align-".concat(m)]=m,r["border-".concat(c)]=c,r["caption-top"]=v||h==="top",r["table-bordered"]=p,r["table-borderless"]=b,r["table-".concat(j)]=j,r["table-hover"]=w,r["table-sm"]=A,r["table-striped"]=R,r["table-striped-columns"]=T,r),P)},O,{ref:a}),(h&&h!=="top"||v)&&s.createElement(oe,null,h||v),x&&s.createElement(U,i({},f),s.createElement(H,null,x.map(function(u,L){return s.createElement(B,i({},u._props&&i({},u._props),u._style&&{style:i({},u._style)},{key:L}),we(u))}))),k&&s.createElement(q,null,k.map(function(u,L){return s.createElement(H,i({},u._props&&i({},u._props),{key:L}),E&&E.map(function(M,Q){return u[M]!==void 0?s.createElement(S,i({},u._cellProps&&i(i({},u._cellProps.all&&i({},u._cellProps.all)),u._cellProps[M]&&i({},u._cellProps[M])),{key:Q}),u[M]):null}))})),t,g&&s.createElement(J,i({},n),s.createElement(H,null,g.map(function(u,L){return s.createElement(S,i({},typeof u=="object"&&u._props&&i({},u._props),{key:L}),typeof u=="object"?u.label:u)})))))});ne.propTypes={align:l.oneOf(["bottom","middle","top"]),borderColor:l.string,bordered:l.bool,borderless:l.bool,caption:l.oneOfType([l.string,l.oneOf(["top"])]),captionTop:l.string,children:l.node,className:l.string,color:I,columns:l.array,footer:l.array,hover:l.bool,items:l.array,responsive:l.oneOfType([l.bool,l.oneOf(["sm","md","lg","xl","xxl"])]),small:l.bool,striped:l.bool,stripedColumns:l.bool,tableFootProps:l.shape(i({},J.propTypes)),tableHeadProps:l.shape(i({},U.propTypes))};ne.displayName="CTable";const Be=()=>{const[e,a]=d.useState([]),[r,t]=d.useState(null),[m,c]=d.useState(!1),[p,b]=d.useState(!1),[h,v]=d.useState(""),[P,j]=d.useState(""),[x,g]=d.useState("");d.useEffect(()=>{w()},[]);const w=async()=>{var n;try{const{data:f}=await Y.get("/users/users");a(f)}catch(f){console.error("Error fetching users:",((n=f.response)==null?void 0:n.data)||f.message),g("User List could not be loaded.")}},k=n=>{t(n),c(!0),T()},F=n=>{t(n),b(!0),v(""),T()},A=async()=>{var n;if(!(r!=null&&r.role)||r.role===""){g("Role cannot be empty");return}try{const f=localStorage.getItem("token"),O=await Y.put(`users/update-user/${r._id}`,{role:r.role,isActive:r.isActive,username:r.username,email:r.email,telegram_username:r.telegram_username||"",whatsapp_number:r.whatsapp_number||""},{headers:{Authorization:`Bearer ${f}`}});j(O.data.message||"User updated successfully"),c(!1),w()}catch(f){console.error("Error updating user:",((n=f.response)==null?void 0:n.data)||f.message),g("Error while updating the user")}},R=async()=>{var n,f,O;if(h.length<6){g("Password shall be at least 6 characters long.");return}try{const E=localStorage.getItem("token"),u=await Y.put(`/users/users/${r._id}/set-password`,{newPassword:h},{headers:{Authorization:`Bearer ${E}`}});j(u.data.message||"Password succesfully updated"),b(!1),w()}catch(E){console.error("Error updating password:",((n=E.response)==null?void 0:n.data)||E.message),g(((O=(f=E.response)==null?void 0:f.data)==null?void 0:O.message)||"Error while updating the password.")}},T=()=>{j(""),g("")};return o.jsxs(o.Fragment,{children:[o.jsx("h3",{children:"User Management"}),P&&o.jsx("div",{className:"alert alert-success",children:P}),x&&o.jsx("div",{className:"alert alert-danger",children:x}),o.jsxs(ne,{hover:!0,responsive:!0,children:[o.jsx(U,{children:o.jsxs(H,{children:[o.jsx(B,{children:"User Name"}),o.jsx(B,{children:"Email"}),o.jsx(B,{children:"Role"}),o.jsx(B,{children:"Status"}),o.jsx(B,{children:"Processes"})]})}),o.jsx(q,{children:e.map(n=>o.jsxs(H,{children:[o.jsx(S,{children:n.username}),o.jsx(S,{children:n.email}),o.jsx(S,{children:n.role}),o.jsx(S,{children:o.jsx("input",{type:"checkbox",checked:n.isActive,onChange:()=>a(e.map(f=>f._id===n._id?{...f,isActive:!f.isActive}:f))})}),o.jsxs(S,{children:[o.jsx(V,{color:"info",onClick:()=>k(n),children:"Düzenle"}),o.jsx(V,{color:"warning",onClick:()=>F(n),children:"Şifre Ayarla"})]})]},n._id))})]}),o.jsxs(W,{visible:m,onClose:()=>c(!1),children:[o.jsx(Z,{closeButton:!0,children:"Modify User"}),o.jsx(G,{children:o.jsxs(be,{children:[o.jsxs("div",{className:"mb-3",children:[o.jsx($,{children:"User Name"}),o.jsx(_,{value:(r==null?void 0:r.username)||"",onChange:n=>t({...r,username:n.target.value})})]}),o.jsxs("div",{className:"mb-3",children:[o.jsx($,{children:"Email"}),o.jsx(_,{type:"email",value:(r==null?void 0:r.email)||"",onChange:n=>t({...r,email:n.target.value})})]}),o.jsxs("div",{className:"mb-3",children:[o.jsx($,{children:"Rol"}),o.jsxs(ee,{value:(r==null?void 0:r.role)||"",onChange:n=>t({...r,role:n.target.value}),children:[o.jsx("option",{value:"",children:"Rol Seçin"}),o.jsx("option",{value:"admin",children:"Admin"}),o.jsx("option",{value:"normal",children:"Normal"})]})]}),o.jsxs("div",{className:"mb-3",children:[o.jsx($,{children:"Aktif"}),o.jsx("input",{type:"checkbox",checked:(r==null?void 0:r.isActive)||!1,onChange:n=>t({...r,isActive:n.target.checked})})]})]})}),o.jsxs(K,{children:[o.jsx(V,{color:"primary",onClick:A,children:"Güncelle"}),o.jsx(V,{color:"secondary",onClick:()=>c(!1),children:"İptal"})]})]}),o.jsxs(W,{visible:p,onClose:()=>b(!1),children:[o.jsx(Z,{closeButton:!0,children:"Arrange Password"}),o.jsx(G,{children:o.jsx(be,{children:o.jsxs("div",{className:"mb-3",children:[o.jsx($,{children:"New Password"}),o.jsx(_,{type:"password",value:h,onChange:n=>v(n.target.value)})]})})}),o.jsxs(K,{children:[o.jsx(V,{color:"primary",onClick:R,children:"Şifreyi Güncelle"}),o.jsx(V,{color:"secondary",onClick:()=>b(!1),children:"İptal"})]})]})]})};export{Be as default};
